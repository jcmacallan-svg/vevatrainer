:root{
  --bg:#0d1117; --panel:#161b22; --panel2:#0f1522; --text:#e6edf3; --muted:#9ba3af;
  --accent:#3aa7ff; --danger:#ff4d4d; --border:#2b3442; --field:#0b1220; --shadow:0 10px 30px rgba(0,0,0,.35);
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;overflow:hidden;}
.topPills{position:fixed;top:10px;left:10px;right:10px;display:flex;gap:10px;z-index:50;pointer-events:none;}
.pill{pointer-events:auto;background:rgba(22,27,34,.9);border:1px solid var(--border);padding:8px 12px;border-radius:999px;color:var(--text);font-size:13px;box-shadow:var(--shadow);}
.app{height:100vh;display:flex;padding-top:54px;}
.sidebar{width:300px;min-width:260px;background:var(--panel);border-right:1px solid var(--border);padding:16px;display:flex;flex-direction:column;gap:10px;}
.brand{padding:10px 10px 14px;border-bottom:1px solid var(--border);margin-bottom:8px;}
.brandTitle{font-weight:800;letter-spacing:.2px;}
.brandSub{color:var(--muted);font-size:12px;margin-top:2px;}
.sideBtn{background:linear-gradient(180deg, rgba(58,167,255,.22), rgba(58,167,255,.08));border:1px solid rgba(58,167,255,.35);color:var(--text);padding:10px 12px;border-radius:12px;text-align:left;cursor:pointer;font-weight:600;}
.sideBtn:hover{filter:brightness(1.08);}
.sideBtn.ghost{background:transparent;border:1px solid var(--border);color:var(--muted);}
.sideBtn.danger{background:linear-gradient(180deg, rgba(255,77,77,.25), rgba(255,77,77,.10));border:1px solid rgba(255,77,77,.45);}
.sideBtn.primary{background:linear-gradient(180deg, rgba(58,167,255,.38), rgba(58,167,255,.18));border:1px solid rgba(58,167,255,.55);}
.sideBtn.small{padding:8px 10px;border-radius:10px;font-size:13px;}
.main{flex:1;display:flex;padding:16px;}
.content{
  flex:1;
  display:grid;
  /* Single column layout: chat (top), hint (above bottom), bottom panel, input */
  grid-template-columns:1fr;
  grid-template-rows:1fr auto auto auto;
  gap:12px;
  width:100%;
  min-height:0;
}
.chatArea{background:var(--panel);border:1px solid var(--border);border-radius:18px;padding:14px;overflow:hidden;min-height:0;display:flex;}
.chatSlots{
  flex: 1;
  overflow: auto;
  padding-right: 4px;
  display: flex;
  flex-direction: column;
  justify-content: flex-end; /* keep bubbles docked at bottom */
}
.chatRow{display:flex;gap:10px;margin:10px 0;align-items:flex-end;}
.chatRow.left{justify-content:flex-start;}
.chatRow.right{justify-content:flex-end;}
.avatar{width:42px;height:42px;border-radius:12px;border:1px solid var(--border);background:#0b1220;flex:0 0 auto;}
.bubble{max-width:74%;background:var(--panel2);border:1px solid var(--border);border-radius:16px;padding:10px 12px;box-shadow:0 6px 18px rgba(0,0,0,.25);}
.chatRow.right .bubble{background:rgba(58,167,255,.12);border-color:rgba(58,167,255,.35);}
.meta{color:var(--muted);font-size:11px;margin-top:6px;}
.typingDots{display:inline-flex;gap:5px;align-items:center;}
.typingDots span{width:6px;height:6px;border-radius:50%;background:var(--muted);animation:blink 1.2s infinite ease-in-out;}
.typingDots span:nth-child(2){animation-delay:.2s}
.typingDots span:nth-child(3){animation-delay:.4s}
@keyframes blink{0%,80%,100%{opacity:.25}40%{opacity:1}}
.rightPanel{
  /* Bottom dock panel (same content as before, but placed at the bottom) */
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:18px;
  padding:14px;
  min-height:0;
  width:100%;

  display:flex;
  flex-direction:column;

  /* keep overall page stable */
  max-height:45vh;
  overflow:auto;
}
.panelHeader{display:flex;flex-direction:column;gap:2px;padding-bottom:10px;border-bottom:1px solid var(--border);}
.panelTitle{font-weight:800;}
.panelSub{color:var(--muted);font-size:12px;}
.panelBody{overflow:auto;padding-top:12px;}
.portraitRow{display:flex;gap:12px;align-items:flex-start;margin-bottom:12px;}
.portraitPhoto{width:84px;height:84px;border-radius:18px;border:1px solid var(--border);background:#0b1220;}
.portraitMood{font-weight:700;}
.portraitDesc{color:var(--muted);margin-top:6px;font-size:13px;line-height:1.35;}
.panelStack{display:flex;flex-direction:column;gap:12px;}
.card{border:1px solid var(--border);border-radius:18px;background:var(--panel2);overflow:hidden;}
.cardTop{display:flex;justify-content:space-between;gap:10px;padding:12px;border-bottom:1px solid var(--border);}
.cardTitle{font-weight:800;}
.cardSub{color:var(--muted);font-size:12px;margin-top:2px;}
.chips{display:flex;flex-direction:column;gap:6px;align-items:flex-end;}
.chip{display:inline-flex;gap:6px;font-size:12px;padding:6px 10px;border-radius:999px;border:1px solid var(--border);background:rgba(255,255,255,.03);color:var(--text);}
.cardBody{padding:12px;}
.cardBottom{padding:12px;border-top:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap;}
.idPhotoWrap{position:relative;width:96px;height:120px;border-radius:14px;overflow:hidden;border:1px solid var(--border);background:#0b1220;}
.idPhoto{width:100%;height:100%;object-fit:cover;display:block;}
.watermark{position:absolute;inset:auto 8px 8px auto;font-size:11px;color:rgba(255,255,255,.75);background:rgba(0,0,0,.35);border:1px solid rgba(255,255,255,.12);padding:3px 6px;border-radius:8px;}
#idCardWrap .cardBody{display:flex;gap:12px;}
.idFields{flex:1;display:flex;flex-direction:column;gap:8px;}
.row{display:flex;justify-content:space-between;gap:10px;}
.k{color:var(--muted);font-size:12px;}
.v{font-weight:700;}
.mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;}
.barcode{padding:6px 10px;border:1px dashed rgba(255,255,255,.2);border-radius:12px;color:rgba(255,255,255,.85);background:rgba(255,255,255,.03);font-size:12px;}
.superRow{display:flex;gap:12px;align-items:flex-start;}
.supervisorPhoto{width:84px;height:84px;border-radius:18px;border:1px solid var(--border);background:#0b1220;object-fit:cover;flex:0 0 auto;}
.superGrid{display:grid;grid-template-columns:1fr 1fr;gap:10px;width:100%;}
.superGrid label{display:flex;flex-direction:column;gap:6px;font-size:12px;color:var(--muted);}
.superGrid input,.superGrid select{background:var(--field);color:var(--text);border:1px solid var(--border);border-radius:12px;padding:10px 10px;outline:none;}
.superGrid input:focus,.superGrid select:focus{border-color:rgba(58,167,255,.55);}
.psOutfit{color:var(--muted);font-size:13px;line-height:1.35;margin-bottom:10px;}
.cards{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
.itemCard{border:1px solid var(--border);background:rgba(255,255,255,.03);border-radius:14px;padding:10px;}
.itemCard .t{font-weight:800;}
.itemCard .s{color:var(--muted);font-size:12px;margin-top:4px;}
.hintBand{grid-column:1/-1;background:rgba(58,167,255,.10);border:1px solid rgba(58,167,255,.25);border-radius:14px;padding:10px 12px;display:flex;align-items:center;gap:10px;}
.dividerLine{flex:1;height:1px;background:rgba(255,255,255,.12);}
.hintText{color:rgba(255,255,255,.92);font-weight:700;}
.inputBar{grid-column:1/-1;display:flex;gap:10px;align-items:center;}
#textInput{flex:1;background:var(--field);color:var(--text);border:1px solid var(--border);border-radius:14px;padding:12px 12px;outline:none;}
#textInput:focus{border-color:rgba(58,167,255,.55);}
.inputBar button{border-radius:14px;border:1px solid var(--border);background:rgba(255,255,255,.03);color:var(--text);padding:12px 14px;cursor:pointer;font-weight:800;}
.inputBar button:hover{filter:brightness(1.08);}
.inputBar button.listening{border-color:rgba(58,167,255,.65);background:rgba(58,167,255,.12);}
.modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.55);z-index:100;}
/* Ensure <div class="modal" hidden> actually disappears */
.modal[hidden]{display:none !important;}
.modalCard{width:min(460px,92vw);background:var(--panel);border:1px solid var(--border);border-radius:18px;padding:16px;box-shadow:var(--shadow);}
.modalTitle{font-weight:900;font-size:18px;margin-bottom:10px;}
.modalCard label{display:flex;flex-direction:column;gap:6px;margin:10px 0;color:var(--muted);font-size:12px;}
.modalCard input,.modalCard select{background:var(--field);border:1px solid var(--border);color:var(--text);border-radius:12px;padding:10px 10px;outline:none;}
.modalCard button.primary{width:100%;margin-top:10px;background:linear-gradient(180deg, rgba(58,167,255,.38), rgba(58,167,255,.18));border:1px solid rgba(58,167,255,.55);}
.loginError{color:rgba(255,77,77,.95);font-weight:800;}
.modalFine{color:var(--muted);font-size:12px;margin-top:10px;}

/* =========================
   OVERRIDE: Start training modal in OLD friendly-blue style
   Paste wins because it's at the end.
   ========================= */

#loginModal{
  background: rgba(5, 10, 20, 0.72);
  backdrop-filter: blur(6px);
}

#loginModal .modalCard{
  width: min(520px, 92vw);
  border-radius: 16px;
  background: linear-gradient(180deg, rgba(17, 33, 56, 0.96), rgba(10, 20, 36, 0.96));
  border: 1px solid rgba(90, 140, 220, 0.22);
  box-shadow: 0 18px 60px rgba(0, 0, 0, 0.55);
  padding: 18px 18px 16px;
}

#loginModal .modalTitle{
  margin: 0 0 10px;
  font-size: 18px;
  font-weight: 800;
  color: rgba(235, 245, 255, 0.96);
  letter-spacing: 0.2px;
}

#loginModal label{
  margin: 10px 0 6px;
  font-size: 12px;
  color: rgba(200, 220, 255, 0.82);
}

#loginModal input[type="text"],
#loginModal select{
  width: 100%;
  height: 40px;
  border-radius: 12px;
  background: rgba(8, 16, 28, 0.75);
  border: 1px solid rgba(90, 140, 220, 0.22);
  color: rgba(235, 245, 255, 0.95);
  padding: 0 12px;
  outline: none;
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.04);
}

#loginModal input::placeholder{
  color: rgba(200, 220, 255, 0.42);
}

#loginModal input:focus,
#loginModal select:focus{
  border-color: rgba(120, 180, 255, 0.55);
  box-shadow: 0 0 0 3px rgba(80, 150, 255, 0.22), inset 0 1px 0 rgba(255,255,255,0.04);
}

/* Make the Start button always look like the old blue style */
#loginModal #btnStartTraining,
#loginModal button.primary{
  width: 100%;
  height: 42px;
  border-radius: 12px;
  border: 1px solid rgba(120, 180, 255, 0.42);
  background: linear-gradient(180deg, rgba(65, 140, 255, 0.88), rgba(38, 95, 210, 0.88));
  color: rgba(245, 250, 255, 0.96);
  font-weight: 800;
  letter-spacing: 0.2px;
  cursor: pointer;
  margin-top: 12px;
}
#loginModal #btnStartTraining:hover,
#loginModal button.primary:hover{ filter: brightness(1.06); }
#loginModal #btnStartTraining:active,
#loginModal button.primary:active{ transform: translateY(1px); filter: brightness(0.98); }

/* Error block */
#loginError{
  margin-top: 10px;
  padding: 10px 12px;
  border-radius: 12px;
  background: rgba(255, 70, 70, 0.10);
  border: 1px solid rgba(255, 70, 70, 0.26);
  color: rgba(255, 210, 210, 0.95);
  font-size: 12px;
}
